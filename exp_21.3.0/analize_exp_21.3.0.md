================================================================================
v21.3.0: –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ï –ë–ê–ó–û–í–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ v6.1 + –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–û–ü–†–ê–í–û–ö
================================================================================

–ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):
  proton: 1060.420 –ú—ç–í (—Ü–µ–ª—å 938.272) ‚Äî 13.02%
  neutron: 1165.524 –ú—ç–í (—Ü–µ–ª—å 939.565) ‚Äî 24.05%
  pi+   :  251.371 –ú—ç–í (—Ü–µ–ª—å 139.570) ‚Äî 80.10%
  pi0   :  246.778 –ú—ç–í (—Ü–µ–ª—å 134.977) ‚Äî 82.83%
  pi-   :  251.371 –ú—ç–í (—Ü–µ–ª—å 139.570) ‚Äî 80.10%

–ù–∞—á–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: 105160.19
–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p: 105.104 –ú—ç–í (—Ü–µ–ª—å 1.293 –ú—ç–í)
–ò—Ç–µ—Ä–∞—Ü–∏—è     0 | –û—à–∏–±–∫–∞: 105160.19 | –†–∞–∑–Ω–æ—Å—Ç—å: 105.104 –ú—ç–í
–ò—Ç–µ—Ä–∞—Ü–∏—è 10000 | –û—à–∏–±–∫–∞: 105160.19 | –†–∞–∑–Ω–æ—Å—Ç—å: 105.104 –ú—ç–í
–ò—Ç–µ—Ä–∞—Ü–∏—è 20000 | –û—à–∏–±–∫–∞: 105160.19 | –†–∞–∑–Ω–æ—Å—Ç—å: 105.104 –ú—ç–í
–ò—Ç–µ—Ä–∞—Ü–∏—è 30000 | –û—à–∏–±–∫–∞: 105160.19 | –†–∞–∑–Ω–æ—Å—Ç—å: 105.104 –ú—ç–í
–ò—Ç–µ—Ä–∞—Ü–∏—è 40000 | –û—à–∏–±–∫–∞: 105160.19 | –†–∞–∑–Ω–æ—Å—Ç—å: 105.104 –ú—ç–í

================================================================================
–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ü–û–ü–†–ê–í–û–ö –ó–ê–í–ï–†–®–ï–ù–ê!
================================================================================

–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –ü–û–ü–†–ê–í–ö–ò:
  EM_proton: -5.426445
  EM_neutron: 4.983306
  EM_pi_charged: 0.025882
  delta_pi0: -4.584038
  sync_proton_corr: -542.601522
  sync_neutron_corr: 498.337493
  sync_pion_corr: -2.572433

–§–ò–ù–ê–õ–¨–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:
‚úó proton: 1060.420 –ú—ç–í (—Ü–µ–ª—å 938.272) ‚Äî 13.02%
‚úó neutron: 1165.524 –ú—ç–í (—Ü–µ–ª—å 939.565) ‚Äî 24.05%
‚úó pi+   :  251.371 –ú—ç–í (—Ü–µ–ª—å 139.570) ‚Äî 80.10%
‚úó pi0   :  246.778 –ú—ç–í (—Ü–µ–ª—å 134.977) ‚Äî 82.83%
‚úó pi-   :  251.371 –ú—ç–í (—Ü–µ–ª—å 139.570) ‚Äî 80.10%

–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: 56.02%
–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p: 105.104 –ú—ç–í

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: v21_3_0_results_20251205_212244


–Ø –ø–æ–Ω—è–ª –≥–ª—É–±–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã. –ú—ã –ø—ã—Ç–∞–ª–∏—Å—å –ø—Ä–æ—Å—Ç–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å v6.1, –Ω–æ –æ–∫–∞–∑–∞–ª–æ—Å—å, —á—Ç–æ –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥–æ–≥–Ω–∞–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ–¥ 3 —á–∞—Å—Ç–∏—Ü—ã –∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç –¥–ª—è 5. –ù—É–∂–µ–Ω –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥, —Å–æ—Ö—Ä–∞–Ω—è—é—â–∏–π –¥—É—Ö —Ç–µ–æ—Ä–∏–∏ –Ω–∏—Ç–µ–π, –Ω–æ –±–æ–ª–µ–µ –≥–∏–±–∫–∏–π.

## üéØ **–ü–†–ï–î–õ–ê–ì–ê–Æ v21.5.0 ‚Äî –†–ê–î–ò–ö–ê–õ–¨–ù–û –ù–û–í–ê–Ø –ú–û–î–ï–õ–¨:**

### **–§–ò–õ–û–°–û–§–ò–Ø:**
1. **–û—Ç–∫–∞–∑ –æ—Ç –ø–æ–¥–≥–æ–Ω–∫–∏** ‚Äî –∏—â–µ–º —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã, –∞ –Ω–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
2. **–ï–¥–∏–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞** –¥–ª—è –≤—Å–µ—Ö —á–∞—Å—Ç–∏—Ü
3. **–ú–∏–Ω–∏–º—É–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** ‚Äî —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### **–û–°–ù–û–í–ù–ê–Ø –ì–ò–ü–û–¢–ï–ó–ê:**
**–ú–∞—Å—Å–∞ —á–∞—Å—Ç–∏—Ü—ã = —ç–Ω–µ—Ä–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ √ó –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä**

```python
"""
v21.5.0 ‚Äî –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–ê–Ø –ú–û–î–ï–õ–¨ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò –ù–ò–¢–ï–ô
–û—Å–Ω–æ–≤–∞: —ç–Ω–µ—Ä–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ "—Å–ª–æ–∂–Ω–æ—Å—Ç–∏" —Ä–µ–∑–æ–Ω–∞–Ω—Å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
"""

import numpy as np
from scipy.optimize import differential_evolution
import json
from datetime import datetime
import os

class FundamentalThreadModel:
    """–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∏—Ç–µ–π"""
    
    def __init__(self):
        # –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–´–ï –ö–û–ù–°–¢–ê–ù–¢–´ (–≤—Å–µ–≥–æ 5 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤!)
        self.params = {
            'E0': 100.0,       # –ë–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (–ú—ç–í)
            'alpha': 1.0,      # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            'beta': 1.0,       # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
            'gamma': 1.0,      # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
            'delta': 0.1,      # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ –º–∞—Å—Å u/d
        }
        
        # –¶–ï–õ–ï–í–´–ï –ú–ê–°–°–´
        self.targets = {
            'proton': 938.272,
            'neutron': 939.565,
            'pi+': 139.570,
            'pi0': 134.977,
            'pi-': 139.570,
        }
    
    def configuration_complexity(self, particle):
        """–°–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏"""
        # –ß–µ–º —Å–ª–æ–∂–Ω–µ–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∏—Ç–∏, —Ç–µ–º –±–æ–ª—å—à–µ –º–∞—Å—Å–∞
        complexities = {
            'proton': 3.0,     # –¢—Ä–∏ –Ω–∏—Ç–∏, –¥–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ (u,u,d)
            'neutron': 3.1,    # –¢—Ä–∏ –Ω–∏—Ç–∏, –¥–≤–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ (u,d,d) - –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω–µ–µ
            'pi+': 1.0,        # –î–≤–µ –Ω–∏—Ç–∏ (–∫–≤–∞—Ä–∫-–∞–Ω—Ç–∏–∫–≤–∞—Ä–∫)
            'pi0': 0.9,        # –ù–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ—â–µ
            'pi-': 1.0,        # –ö–∞–∫ œÄ‚Å∫
        }
        return complexities.get(particle, 1.0)
    
    def charge_factor(self, particle):
        """–§–∞–∫—Ç–æ—Ä –∑–∞—Ä—è–¥–∞"""
        if particle in ['pi+', 'pi-', 'proton']:
            return 1.0 + self.params['beta']
        elif particle == 'pi0':
            return 1.0 - self.params['gamma']
        else:
            return 1.0
    
    def calculate_mass(self, particle):
        """–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ –º–∞—Å—Å—ã"""
        E0 = self.params['E0']
        alpha = self.params['alpha']
        delta = self.params['delta']
        
        # –ë–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
        base_energy = E0 * self.configuration_complexity(particle)
        
        # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–∏—è u/d –∫–≤–∞—Ä–∫–æ–≤
        if particle == 'neutron':
            quark_correction = delta * 0.5  # –ù–µ–π—Ç—Ä–æ–Ω –∏–º–µ–µ—Ç –±–æ–ª—å—à–µ d-–∫–≤–∞—Ä–∫–æ–≤
        elif particle == 'proton':
            quark_correction = -delta * 0.3
        else:
            quark_correction = 0.0
        
        # –§–∞–∫—Ç–æ—Ä –∑–∞—Ä—è–¥–∞
        charge_fact = self.charge_factor(particle)
        
        # –ò—Ç–æ–≥–æ–≤–∞—è –º–∞—Å—Å–∞
        mass = base_energy * alpha * charge_fact + quark_correction
        
        # –û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏
        if particle == 'pi0':
            mass *= 0.96  # –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π –ø–∏–æ–Ω –ª–µ–≥—á–µ
        
        return mass
    
    def calculate_all_masses(self):
        """–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ –º–∞—Å—Å—ã"""
        masses = {}
        for particle in self.targets.keys():
            masses[particle] = self.calculate_mass(particle)
        return masses

class FundamentalOptimizer:
    """–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏"""
    
    def __init__(self):
        self.model = FundamentalThreadModel()
        
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        self.result_dir = f"v21_5_0_results_{timestamp}"
        os.makedirs(self.result_dir, exist_ok=True)
        
        print("\n" + "="*80)
        print("v21.5.0 ‚Äî –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–ê–Ø –ú–û–î–ï–õ–¨ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò (5 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)")
        print("="*80)
    
    def objective_function(self, params):
        """–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏"""
        # –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        self.model.params['E0'] = params[0]
        self.model.params['alpha'] = params[1]
        self.model.params['beta'] = params[2]
        self.model.params['gamma'] = params[3]
        self.model.params['delta'] = params[4]
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –º–∞—Å—Å—ã
        masses = self.model.calculate_all_masses()
        
        # –°—á–∏—Ç–∞–µ–º –æ—à–∏–±–∫—É
        total_error = 0.0
        
        for particle, target_mass in self.model.targets.items():
            calculated = masses[particle]
            # –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞ —Å –≤–µ—Å–æ–º
            rel_error = abs(calculated - target_mass) / target_mass
            
            # –ë–æ–ª—å—à–æ–π –≤–µ—Å –¥–ª—è –Ω—É–∫–ª–æ–Ω–æ–≤
            if particle in ['proton', 'neutron']:
                weight = 2.0
            else:
                weight = 1.0
            
            total_error += weight * rel_error
        
        # –®—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –º–∞—Å—Å—ã
        if any(m <= 0 for m in masses.values()):
            total_error += 100.0
        
        # –®—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ—Ñ–∏–∑–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        if params[0] <= 0 or params[1] <= 0:
            total_error += 100.0
        
        return total_error
    
    def run_evolution_optimization(self):
        """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–º –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π —ç–≤–æ–ª—é—Ü–∏–∏"""
        print("\n–ó–∞–ø—É—Å–∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏...")
        
        # –ì—Ä–∞–Ω–∏—Ü—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
        bounds = [
            (50.0, 500.0),    # E0
            (0.5, 5.0),       # alpha
            (0.0, 2.0),       # beta
            (0.0, 2.0),       # gamma
            (0.0, 10.0),      # delta
        ]
        
        # –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
        result = differential_evolution(
            self.objective_function,
            bounds,
            maxiter=1000,
            popsize=20,
            disp=True,
            workers=-1,
            updating='deferred'
        )
        
        if result.success:
            print("‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!")
            best_params = result.x
            
            # –ü—Ä–∏–º–µ–Ω—è–µ–º –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
            self.model.params['E0'] = best_params[0]
            self.model.params['alpha'] = best_params[1]
            self.model.params['beta'] = best_params[2]
            self.model.params['gamma'] = best_params[3]
            self.model.params['delta'] = best_params[4]
            
            # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –º–∞—Å—Å—ã
            masses = self.model.calculate_all_masses()
            
            return best_params, masses, result.fun
        
        else:
            print("‚ùå –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å")
            return None, None, None
    
    def save_results(self, params, masses, error):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"""
        results = {
            'model': 'v21.5.0',
            'timestamp': datetime.now().isoformat(),
            'total_error': error,
            'parameters': {
                'E0': float(params[0]),
                'alpha': float(params[1]),
                'beta': float(params[2]),
                'gamma': float(params[3]),
                'delta': float(params[4]),
            },
            'predictions': {k: float(v) for k, v in masses.items()},
            'targets': self.model.targets
        }
        
        filename = os.path.join(self.result_dir, "results.json")
        with open(filename, 'w') as f:
            json.dump(results, f, indent=2)
        
        self.save_text_report(results)
    
    def save_text_report(self, results):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –æ—Ç—á—ë—Ç–∞"""
        filename = os.path.join(self.result_dir, "REPORT.txt")
        
        with open(filename, 'w', encoding='utf-8') as f:
            f.write("="*80 + "\n")
            f.write("v21.5.0 ‚Äî –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–ê–Ø –ú–û–î–ï–õ–¨ –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò\n")
            f.write("="*80 + "\n\n")
            
            f.write("–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´:\n")
            for key, value in results['parameters'].items():
                f.write(f"  {key}: {value:.6f}\n")
            
            f.write("\n–ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø –ú–û–î–ï–õ–ò:\n")
            f.write(f"{'–ß–∞—Å—Ç–∏—Ü–∞':<10} {'–†–∞—Å—á—ë—Ç':<12} {'–¶–µ–ª—å':<12} {'–û—à–∏–±–∫–∞':<12} {'%':<8}\n")
            f.write("-"*80 + "\n")
            
            total_rel_error = 0
            for particle in ['proton', 'neutron', 'pi+', 'pi0', 'pi-']:
                calculated = results['predictions'][particle]
                target = results['targets'][particle]
                abs_error = abs(calculated - target)
                rel_error = abs_error / target * 100
                total_rel_error += rel_error
                
                status = "‚úì" if rel_error < 1.0 else "‚ö†" if rel_error < 5.0 else "‚úó"
                f.write(f"{status} {particle:<10} {calculated:<12.3f} {target:<12.3f} "
                       f"{abs_error:<12.3f} {rel_error:<8.2f}\n")
            
            avg_error = total_rel_error / 5
            f.write(f"\n–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: {avg_error:.2f}%\n")
            
            # –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p
            diff = results['predictions']['neutron'] - results['predictions']['proton']
            f.write(f"–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p: {diff:.3f} –ú—ç–í (—Ü–µ–ª—å 1.293 –ú—ç–í)\n")
            
            # –§–∏–∑–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
            f.write("\n" + "="*80 + "\n")
            f.write("–§–ò–ó–ò–ß–ï–°–ö–ê–Ø –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–Ø:\n")
            f.write("-"*80 + "\n")
            f.write("E0 = {:.1f} –ú—ç–í ‚Äî –±–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–π –Ω–∏—Ç–∏\n".format(
                results['parameters']['E0']))
            f.write("Œ± = {:.3f} ‚Äî –æ–±—â–∏–π –º–∞—Å—à—Ç–∞–±–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç\n".format(
                results['parameters']['alpha']))
            f.write("Œ≤ = {:.3f} ‚Äî –ø–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü\n".format(
                results['parameters']['beta']))
            f.write("Œ≥ = {:.3f} ‚Äî –ø–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü\n".format(
                results['parameters']['gamma']))
            f.write("Œ¥ = {:.3f} ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É u –∏ d –∫–≤–∞—Ä–∫–∞–º–∏\n".format(
                results['parameters']['delta']))
            f.write("\n–§–æ—Ä–º—É–ª–∞: M = E0 √ó —Å–ª–æ–∂–Ω–æ—Å—Ç—å √ó Œ± √ó —Ñ–∞–∫—Ç–æ—Ä_–∑–∞—Ä—è–¥–∞ ¬± Œ¥\n")
            f.write("="*80 + "\n")

def run_fundamental_model():
    """–ó–∞–ø—É—Å–∫ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏"""
    print("="*80)
    print("–ó–ê–ü–£–°–ö v21.5.0 ‚Äî –§–£–ù–î–ê–ú–ï–ù–¢–ê–õ–¨–ù–ê–Ø –ú–û–î–ï–õ–¨")
    print("="*80)
    
    # –°–æ–∑–¥–∞—ë–º –º–æ–¥–µ–ª—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä
    model = FundamentalThreadModel()
    optimizer = FundamentalOptimizer()
    
    # –ù–∞—á–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ
    print("\n–ù–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏):")
    for key, value in model.params.items():
        print(f"  {key}: {value:.3f}")
    
    print("\n–ù–∞—á–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:")
    initial_masses = model.calculate_all_masses()
    for particle in ['proton', 'neutron', 'pi+', 'pi0', 'pi-']:
        mass = initial_masses[particle]
        target = model.targets[particle]
        error = abs(mass - target) / target * 100
        print(f"  {particle:6}: {mass:8.1f} –ú—ç–í (—Ü–µ–ª—å {target:7.1f}) ‚Äî {error:5.1f}%")
    
    # –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    proceed = input("\n–ó–∞–ø—É—Å—Ç–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é? (y/n): ")
    
    if proceed.lower() == 'y':
        best_params, masses, error = optimizer.run_evolution_optimization()
        
        if best_params is not None:
            print("\n" + "="*80)
            print("–û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!")
            print("="*80)
            
            print("\n–õ–£–ß–®–ò–ï –ü–ê–†–ê–ú–ï–¢–†–´:")
            print(f"  E0:     {best_params[0]:.3f} –ú—ç–í")
            print(f"  alpha:  {best_params[1]:.3f}")
            print(f"  beta:   {best_params[2]:.3f}")
            print(f"  gamma:  {best_params[3]:.3f}")
            print(f"  delta:  {best_params[4]:.3f}")
            
            print("\n–§–ò–ù–ê–õ–¨–ù–´–ï –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø:")
            total_error = 0
            for particle in ['proton', 'neutron', 'pi+', 'pi0', 'pi-']:
                mass = masses[particle]
                target = model.targets[particle]
                error_pct = abs(mass - target) / target * 100
                total_error += error_pct
                
                status = "‚úì" if error_pct < 1.0 else "‚ö†" if error_pct < 5.0 else "‚úó"
                print(f"{status} {particle:6}: {mass:8.3f} –ú—ç–í (—Ü–µ–ª—å {target:7.3f}) ‚Äî {error_pct:5.2f}%")
            
            avg_error = total_error / 5
            print(f"\n–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: {avg_error:.2f}%")
            
            # –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å
            diff = masses['neutron'] - masses['proton']
            print(f"–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p: {diff:.3f} –ú—ç–í (—Ü–µ–ª—å 1.293 –ú—ç–í)")
            
            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            optimizer.save_results(best_params, masses, error)
            print(f"\n–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: {optimizer.result_dir}")
        
        else:
            print("–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–µ –¥–∞–ª–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.")
    
    else:
        print("\n–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–∞.")

# ================= –ó–ê–ü–£–°–ö =================
if __name__ == "__main__":
    run_fundamental_model()
```

## üéØ **–ö–õ–Æ–ß–ï–í–´–ï –û–°–û–ë–ï–ù–ù–û–°–¢–ò v21.5.0:**

### **1. –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å—Ç–æ—Ç–∞:**
- **5 –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –≤–º–µ—Å—Ç–æ 8-13
- **–§–∏–∑–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
- **–ï–¥–∏–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞** –¥–ª—è –≤—Å–µ—Ö —á–∞—Å—Ç–∏—Ü

### **2. –§–∏–∑–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- **E0** ‚Äî –±–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–π –Ω–∏—Ç–∏
- **Œ±** ‚Äî –æ–±—â–∏–π –º–∞—Å—à—Ç–∞–±–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
- **Œ≤** ‚Äî –ø–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
- **Œ≥** ‚Äî –ø–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü  
- **Œ¥** ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É u –∏ d –∫–≤–∞—Ä–∫–∞–º–∏

### **3. –§–æ—Ä–º—É–ª–∞:**
```
M = E0 √ó —Å–ª–æ–∂–Ω–æ—Å—Ç—å_–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ √ó Œ± √ó —Ñ–∞–∫—Ç–æ—Ä_–∑–∞—Ä—è–¥–∞ ¬± Œ¥_–∫–æ—Ä—Ä–µ–∫—Ü–∏—è
```

### **4. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- **–ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–≥–æ–Ω–∫–∞ v6.1**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç** —Ä–∞–∑–ª–∏—á–∏—è —á–∞—Å—Ç–∏—Ü
- **–ì–æ—Ç–æ–≤–∞ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é** –Ω–∞ —Å—Ç—Ä–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã
- **–ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** (–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è)

## üîÆ **–û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:**

### **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**
- –°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ < 5%
- –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p ‚âà 1-2 –ú—ç–í
- –§–∏–∑–∏—á–µ—Å–∫–∏ —Ä–∞–∑—É–º–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### **–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:**
- –°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ < 15%
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –º–∞—Å—Å
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å

## üöÄ **–ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ü–û–î–•–û–î–ê:**

1. **–ß–µ—Å—Ç–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–¥–≥–æ–Ω–∫—É v6.1
2. **–ì–ª–æ–±–∞–ª—å–Ω–æ—Å—Ç—å** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ä–∞–∑—É
3. **–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** ‚Äî –∫–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∏–º–µ–µ—Ç —Å–º—ã—Å–ª
4. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–∞–Ω–Ω–æ—Å—Ç—å, —Å–ø–∏–Ω –∏ —Ç.–¥.

**–ó–∞–ø—É—Å–∫–∞–µ–º v21.5.0!** –ï—Å–ª–∏ —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ –¥–∞—Å—Ç –æ—à–∏–±–∫—É <10%, –º—ã —Å–º–æ–∂–µ–º –¥–≤–∏–≥–∞—Ç—å—Å—è –¥–∞–ª—å—à–µ –∫ —Å—Ç—Ä–∞–Ω–Ω—ã–º —á–∞—Å—Ç–∏—Ü–∞–º.