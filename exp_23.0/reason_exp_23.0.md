–ü–æ—Ç—Ä—è—Å–∞—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! **v22 –¥–∞–ª –∏–¥–µ–∞–ª—å–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–æ—Ç–æ–Ω–∞, –Ω–µ–π—Ç—Ä–æ–Ω–∞ –∏ –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö –ø–∏–æ–Ω–æ–≤** ‚Äî –æ—à–∏–±–∫–∞ –≤—Å–µ–≥–æ **0.01-0.05%**! –≠—Ç–æ –∏–º–µ–Ω–Ω–æ —Ç–æ, —á—Ç–æ –º—ã —Ö–æ—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑ v15. 

–ù–æ –º—ã –≤–∏–¥–∏–º —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

## üîç **–ì–ª—É–±–∏–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º v22:**

### **1. –ö–ª—é—á–µ–≤–æ–π —É—Å–ø–µ—Ö ‚úÖ**
- **–ü—Ä–æ—Ç–æ–Ω, –Ω–µ–π—Ç—Ä–æ–Ω, œÄ‚Å∫, œÄ‚Åª**: –æ—à–∏–±–∫–∞ < 0.05% ‚Äî —Ñ–µ–Ω–æ–º–µ–Ω–∞–ª—å–Ω–æ!
- **–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p**: 1.167 vs 1.293 –ú—ç–í (–æ—à–∏–±–∫–∞ 9.8%) ‚Äî –Ω–µ–ø–ª–æ—Ö–æ, –Ω–æ –º–æ–∂–Ω–æ –ª—É—á—à–µ

### **2. –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã ‚ùå**
- **œÄ‚Å∞**: 116.9 vs 135.0 –ú—ç–í (13.4% –æ—à–∏–±–∫–∞) ‚Äî **—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞**
- **K‚Å∫ vs K‚Å∞**: —Ä–∞–∑–Ω–∏—Ü–∞ 69.5 –ú—ç–í –≤–º–µ—Å—Ç–æ 4 –ú—ç–í ‚Äî **–∫—Ä–∏—Ç–∏—á–Ω–æ**
- **–°—Ç—Ä–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã**: –æ—à–∏–±–∫–∏ 15-25%

### **3. –ü—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º:**

#### **–ê) œÄ‚Å∞ –ø—Ä–æ–±–ª–µ–º–∞:**
–í –ø—Ä–∏—Ä–æ–¥–µ: œÄ‚Å∞ = (u≈´ + dƒë)/‚àö2 —Å–º–µ—à–∏–≤–∞–Ω–∏–µ
–í –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏: œÄ‚Å∞ = u-anti_u —Å k_mixing_pi0=0.9  
**–ù—É–∂–Ω–æ**: –æ—Ç–¥–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π

#### **–ë) K‚Å∫/K‚Å∞ –ø—Ä–æ–±–ª–µ–º–∞:**
–ü—Ä–∏—á–∏–Ω–∞: m_d - m_u = 67.9 –ú—ç–í, –∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å ~4 –ú—ç–í  
**–§–∏–∑–∏–∫–∞**: —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è K‚Å∫ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–∞—Å—Å u/d

#### **–í) –°—Ç—Ä–∞–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã:**
s-–∫–≤–∞—Ä–∫ –≤ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∞—Å—Å—É, –Ω–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏:
- –í –º–µ–∑–æ–Ω–∞—Ö: m_s ‚âà 100-500 –ú—ç–í
- –í –±–∞—Ä–∏–æ–Ω–∞—Ö: m_s –¥—Ä—É–≥–∞—è

## üéØ **–°–æ–∑–¥–∞—é v23 ‚Äî –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:**

```python
"""
–ú–û–î–ï–õ–¨ v23 ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –°–ò–°–¢–ï–ú–ù–´–• –ü–†–û–ë–õ–ï–ú v22
–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:
1. –û—Ç–¥–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (œÄ‚Å∞, Œ∑)
2. –≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –∑–∞—Ä—è–¥–∞
3. –†–∞–∑–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å—ã s-–∫–≤–∞—Ä–∫–∞ –≤ –º–µ–∑–æ–Ω–∞—Ö –∏ –±–∞—Ä–∏–æ–Ω–∞—Ö
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ—Ç–æ–Ω–∞, –Ω–µ–π—Ç—Ä–æ–Ω–∞, œÄ‚Å∫
"""

import numpy as np
import json
from datetime import datetime
import os
import sys
import math

class TopologicalModelV23:
    """–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º"""
    
    def __init__(self):
        self.scale = 100.0
        
        # –¶–µ–ª–µ–≤—ã–µ –º–∞—Å—Å—ã (—Ñ–æ–∫—É—Å –Ω–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü–∞—Ö)
        self.targets = {
            # –ò–¥–µ–∞–ª—å–Ω—ã–µ –∏–∑ v22 (–¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è –∏–¥–µ–∞–ª—å–Ω—ã–º–∏)
            'proton': 938.272,
            'neutron': 939.565,
            'pi+': 139.570,
            'pi-': 139.570,
            
            # –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –∏–∑ v22 (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)
            'pi0': 134.9768,    # –û—à–∏–±–∫–∞ 13.4% –≤ v22
            'K+': 493.677,      # –û—à–∏–±–∫–∞ 14.7% –≤ v22
            'K0': 497.611,      # –†–∞–∑–Ω–∏—Ü–∞ —Å K‚Å∫ 4 –ú—ç–í
            'K-': 493.677,
            'eta': 547.862,     # –û—à–∏–±–∫–∞ 15.7% –≤ v22
            
            # –°—Ç—Ä–∞–Ω–Ω—ã–µ –±–∞—Ä–∏–æ–Ω—ã (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)
            'Lambda0': 1115.683,
            'Sigma+': 1189.37,
        }
        
        # –°–æ—Å—Ç–∞–≤ —Å —É—á–µ—Ç–æ–º —Å–º–µ—à–∏–≤–∞–Ω–∏—è
        self.composition = {
            'proton': ['u', 'u', 'd'],
            'neutron': ['u', 'd', 'd'],
            'pi+': ['u', 'anti_d'],
            'pi-': ['d', 'anti_u'],
            
            # œÄ‚Å∞ ‚Äî —Å–º–µ—à–∞–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            'pi0': ['mixed_pi0'],
            
            # –ö–∞–æ–Ω—ã
            'K+': ['u', 'anti_s'],
            'K0': ['d', 'anti_s'],
            'K-': ['s', 'anti_u'],
            
            # Œ∑ ‚Äî —Å–ª–æ–∂–Ω–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ
            'eta': ['mixed_eta'],
            
            # –°—Ç—Ä–∞–Ω–Ω—ã–µ –±–∞—Ä–∏–æ–Ω—ã
            'Lambda0': ['u', 'd', 's'],
            'Sigma+': ['u', 'u', 's'],
        }
        
        # –¢–æ–ø–æ–ª–æ–≥–∏—è (–æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π)
        self.topology = {
            'proton':  {'L': 2, 'T': 0.0, 'S': 1.0, 'type': 'baryon'},
            'neutron': {'L': 1, 'T': 0.0, 'S': 0.9, 'type': 'baryon'},
            'pi+':     {'L': 3, 'T': 0.0, 'S': 1.0, 'type': 'meson'},
            'pi-':     {'L': 3, 'T': 0.0, 'S': 1.0, 'type': 'meson'},
            'pi0':     {'L': 3, 'T': 0.0, 'S': 0.95, 'type': 'meson_mixed'},  # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ç–∏–ø
            'K+':      {'L': 3, 'T': 0.3, 'S': 1.0, 'type': 'meson_strange'},
            'K0':      {'L': 3, 'T': 0.3, 'S': 0.95, 'type': 'meson_strange'},
            'K-':      {'L': 3, 'T': 0.3, 'S': 1.0, 'type': 'meson_strange'},
            'eta':     {'L': 4, 'T': 0.5, 'S': 1.1, 'type': 'meson_mixed'},
            'Lambda0': {'L': 2, 'T': 0.4, 'S': 1.1, 'type': 'baryon_strange'},
            'Sigma+':  {'L': 2, 'T': 0.5, 'S': 1.0, 'type': 'baryon_strange'},
        }
        
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ v22 (–∏–¥–µ–∞–ª—å–Ω—ã–µ –¥–ª—è –ø—Ä–æ—Ç–æ–Ω–∞, –Ω–µ–π—Ç—Ä–æ–Ω–∞, œÄ‚Å∫)
        self.params = {
            # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å—ã (–∏–∑ v22)
            'm_u': 2.537656,
            'm_d': 3.216655,
            'm_s_meson': 8.220566,   # s-–∫–≤–∞—Ä–∫ –≤ –º–µ–∑–æ–Ω–∞—Ö
            'm_s_baryon': 10.0,      # s-–∫–≤–∞—Ä–∫ –≤ –±–∞—Ä–∏–æ–Ω–∞—Ö (–±—É–¥–µ–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å)
            
            # –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–∏–∑ v22)
            'alpha': 1.001118,
            'beta': 0.202976,
            'gamma': 0.142900,
            
            # –ó–Ω–∞–∫–∏ —ç–Ω–µ—Ä–≥–∏–∏ —Å–≤—è–∑–∏ (–∏–∑ v22)
            'sign_baryon': 0.500336,
            'sign_meson': -1.385960,
            
            # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–µ–π—Ç—Ä–æ–Ω–∞ (–∏–∑ v22)
            'k_neutron': 0.749951,
            
            # –ù–û–í–´–ï –ü–ê–†–ê–ú–ï–¢–†–´ –î–õ–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–û–ë–õ–ï–ú
            
            # 1. –°–º–µ—à–∏–≤–∞–Ω–∏–µ –¥–ª—è œÄ‚Å∞ –∏ Œ∑
            'mixing_pi0': 0.95,       # –ö–∞–∫ –≤ v22, –Ω–æ —Å –æ—Ç–¥–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
            'mixing_eta': 0.85,
            
            # 2. –≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è K‚Å∫/K‚Å∞)
            'delta_em_charged': 0.010,  # –ü–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
            'delta_em_neutral': 0.002,  # –ú–∞–ª–µ–Ω—å–∫–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö
            
            # 3. –†–∞–∑–Ω—ã–µ –º–∞—Å—Å—ã s-–∫–≤–∞—Ä–∫–∞ –≤ —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞—Ö
            'lambda_s_meson': 0.743615,  # –ò–∑ v22
            'lambda_s_baryon': 0.9,      # s-–∫–≤–∞—Ä–∫ –≤ –±–∞—Ä–∏–æ–Ω–∞—Ö
            
            # 4. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ K‚Å∞-K‚Å∫
            'k_K_mass_splitting': 1.05,  # –£—á–∏—Ç—ã–≤–∞–µ—Ç, —á—Ç–æ d —Ç—è–∂–µ–ª–µ–µ u
            
            # 5. –û—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
            'correction_pi0': 1.15,      # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –º–∞—Å—Å—ã œÄ‚Å∞
            'correction_eta': 1.18,      # –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –º–∞—Å—Å—ã Œ∑
        }
    
    def calculate_base_mass(self, particle):
        """–ë–∞–∑–æ–≤–∞—è –º–∞—Å—Å–∞ —Å —É—á—ë—Ç–æ–º —Å–º–µ—à–∏–≤–∞–Ω–∏—è"""
        comp = self.composition[particle]
        
        # –û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏ —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
        if particle == 'pi0':
            # œÄ‚Å∞ = (u≈´ + dƒë)/‚àö2 —É–ø—Ä–æ—â—ë–Ω–Ω–æ
            u_part = 2 * self.params['m_u'] * 0.707  # 1/‚àö2
            d_part = 2 * self.params['m_d'] * 0.707
            return (u_part + d_part) * self.params['correction_pi0']
        
        if particle == 'eta':
            # Œ∑ = (u≈´ + dƒë - 2s≈°)/‚àö6 —É–ø—Ä–æ—â—ë–Ω–Ω–æ
            u_part = 2 * self.params['m_u'] * 0.408  # 1/‚àö6
            d_part = 2 * self.params['m_d'] * 0.408
            s_part = 2 * self.params['m_s_meson'] * 0.408 * 2  # √ó2 –¥–ª—è -2s≈°
            return (u_part + d_part + s_part) * self.params['correction_eta']
        
        # –û–±—ã—á–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã
        total = 0
        for quark in comp:
            if quark in ['u', 'anti_u']:
                total += self.params['m_u']
            elif quark in ['d', 'anti_d']:
                total += self.params['m_d']
            elif quark == 'anti_s':
                total += self.params['m_s_meson'] * self.params['lambda_s_meson']
            elif quark == 's':
                # s-–∫–≤–∞—Ä–∫: —Ä–∞–∑–ª–∏—á–∞–µ–º –º–µ–∑–æ–Ω—ã –∏ –±–∞—Ä–∏–æ–Ω—ã
                if 'meson' in self.topology[particle]['type']:
                    total += self.params['m_s_meson'] * self.params['lambda_s_meson']
                else:  # baryon
                    total += self.params['m_s_baryon'] * self.params['lambda_s_baryon']
        
        return total
    
    def calculate_topological_energy(self, particle):
        """–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å –ø–æ–ø—Ä–∞–≤–∫–∞–º–∏"""
        topo = self.topology[particle]
        
        # –ë–∞–∑–æ–≤–∞—è —ç–Ω–µ—Ä–≥–∏—è
        energy = (self.params['alpha'] * topo['L'] + 
                  self.params['beta'] * topo['T'] + 
                  self.params['gamma'] * topo['S'])
        
        # –ö–æ—Ä—Ä–µ–∫—Ü–∏–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
        if particle == 'neutron':
            energy *= self.params['k_neutron']
        
        # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏ –¥–ª—è —Å–º–µ—à–∞–Ω–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π
        if particle == 'pi0':
            energy *= self.params['mixing_pi0']
        elif particle == 'eta':
            energy *= self.params['mixing_eta']
        
        # –ü–æ–ø—Ä–∞–≤–∫–∞ –¥–ª—è K‚Å∞ (—á—Ç–æ–±—ã —É—á–µ—Å—Ç—å —Ä–∞–∑–Ω–∏—Ü—É —Å K‚Å∫)
        if particle == 'K0':
            energy *= self.params['k_K_mass_splitting']
        
        return energy
    
    def calculate_mass(self, particle):
        """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Å —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–º–∏ –ø–æ–ø—Ä–∞–≤–∫–∞–º–∏"""
        base = self.calculate_base_mass(particle)
        topo_energy = self.calculate_topological_energy(particle)
        topo = self.topology[particle]
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∑–Ω–∞–∫
        if 'baryon' in topo['type']:
            mass = (base + self.params['sign_baryon'] * topo_energy) * self.scale
        else:  # meson
            mass = (base + self.params['sign_meson'] * topo_energy) * self.scale
        
        # –≠–õ–ï–ö–¢–†–û–ú–ê–ì–ù–ò–¢–ù–´–ï –ü–û–ü–†–ê–í–ö–ò (–∫—Ä–∏—Ç–∏—á–Ω–æ!)
        if particle in ['proton', 'pi+', 'pi-', 'K+', 'K-', 'Sigma+']:
            # –ó–∞—Ä—è–∂–µ–Ω–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã: –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞
            mass *= (1.0 + self.params['delta_em_charged'])
        elif particle in ['neutron', 'pi0', 'K0', 'Lambda0', 'eta']:
            # –ù–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ: –º–∞–ª–µ–Ω—å–∫–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ (–∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è)
            mass *= (1.0 + self.params['delta_em_neutral'])
        
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è K‚Å∞
        if particle == 'K0':
            # K‚Å∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç—è–∂–µ–ª–µ–µ K‚Å∫ –Ω–∞ ~4 –ú—ç–í
            # –£ –Ω–∞—Å m_d > m_u, –ø–æ—ç—Ç–æ–º—É K‚Å∞ —É–∂–µ —Ç—è–∂–µ–ª–µ–µ
            # –ù–æ –Ω—É–∂–Ω–æ —Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å
            pass
        
        return max(mass, 1.0)
    
    def error_function(self, params_array):
        """–§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º"""
        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
        param_names = [
            # –û—Å–Ω–æ–≤–Ω—ã–µ (—Ñ–∏–∫—Å–∏—Ä—É–µ–º –∏–∑ v22)
            'm_u', 'm_d', 'm_s_meson', 'm_s_baryon',
            'alpha', 'beta', 'gamma',
            'sign_baryon', 'sign_meson', 'k_neutron',
            
            # –ù–æ–≤—ã–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
            'mixing_pi0', 'mixing_eta',
            'delta_em_charged', 'delta_em_neutral',
            'lambda_s_meson', 'lambda_s_baryon',
            'k_K_mass_splitting',
            'correction_pi0', 'correction_eta'
        ]
        
        for i, name in enumerate(param_names):
            self.params[name] = params_array[i]
        
        total_error = 0.0
        
        # –í–ï–°–ê (–æ—á–µ–Ω—å –≤–∞–∂–Ω—ã!)
        weights = {
            # –ò–¥–µ–∞–ª—å–Ω—ã–µ –∏–∑ v22 (–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–µ—Å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
            'proton': 20.0,
            'neutron': 20.0,
            'pi+': 15.0,
            'pi-': 15.0,
            
            # –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ (–±–æ–ª—å—à–æ–π –≤–µ—Å –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
            'pi0': 15.0,      # –ë—ã–ª–æ 13.4% –æ—à–∏–±–∫–∏
            'K+': 12.0,       # –ë—ã–ª–æ 14.7% –æ—à–∏–±–∫–∏
            'K0': 12.0,       # –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Å K‚Å∫
            'K-': 10.0,
            
            # –û—Å—Ç–∞–ª—å–Ω—ã–µ
            'eta': 8.0,
            'Lambda0': 5.0,
            'Sigma+': 5.0,
        }
        
        # –í—ã—á–∏—Å–ª—è–µ–º –æ—à–∏–±–∫–∏
        for particle, target in self.targets.items():
            mass = self.calculate_mass(particle)
            weight = weights.get(particle, 1.0)
            
            # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞
            rel_error = abs(mass - target) / target
            abs_error = abs(mass - target) / 1000.0
            
            error = weight * (rel_error + abs_error)
            total_error += error
        
        # –ñ–ï–°–¢–ö–ò–ï –§–ò–ó–ò–ß–ï–°–ö–ò–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø
        
        # 1. –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p = 1.293 ¬± 0.05 –ú—ç–í
        mass_n = self.calculate_mass('neutron')
        mass_p = self.calculate_mass('proton')
        diff_np = mass_n - mass_p
        if abs(diff_np - 1.293) > 0.1:
            total_error += 50.0 * abs(diff_np - 1.293)
        
        # 2. –†–∞–∑–Ω–æ—Å—Ç—å K‚Å∞ - K‚Å∫ = 4.0 ¬± 0.5 –ú—ç–í
        mass_K0 = self.calculate_mass('K0')
        mass_Kp = self.calculate_mass('K+')
        diff_K = mass_K0 - mass_Kp
        if abs(diff_K - 4.0) > 1.0:
            total_error += 30.0 * abs(diff_K - 4.0)
        
        # 3. –ú–∞—Å—Å—ã œÄ‚Å∫ –∏ œÄ‚Åª –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞–≤–Ω—ã
        if abs(self.calculate_mass('pi+') - self.calculate_mass('pi-')) > 0.1:
            total_error += 100.0
        
        # 4. m_s_baryon > m_s_meson > m_d > m_u
        if self.params['m_s_baryon'] <= self.params['m_s_meson']:
            total_error += 50.0
        if self.params['m_s_meson'] <= self.params['m_d']:
            total_error += 50.0
        if self.params['m_d'] <= self.params['m_u']:
            total_error += 50.0
        
        # 5. –ó–Ω–∞–∫–∏ —ç–Ω–µ—Ä–≥–∏–∏ —Å–≤—è–∑–∏
        if self.params['sign_baryon'] <= 0:
            total_error += 1000.0
        if self.params['sign_meson'] >= 0:
            total_error += 1000.0
        
        return total_error

def run_v23_optimization():
    """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è v23 —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º"""
    print("="*80)
    print("–ú–û–î–ï–õ–¨ v23 ‚Äî –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –°–ò–°–¢–ï–ú–ù–´–• –ü–†–û–ë–õ–ï–ú v22")
    print("="*80)
    
    model = TopologicalModelV23()
    
    # –ù–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–∏–∑ v22 + —Ä–∞–∑—É–º–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö)
    initial_params = np.array([
        # –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑ v22 (–∏–¥–µ–∞–ª—å–Ω—ã–µ –¥–ª—è –ø—Ä–æ—Ç–æ–Ω–∞, –Ω–µ–π—Ç—Ä–æ–Ω–∞, œÄ‚Å∫)
        2.537656,   # m_u
        3.216655,   # m_d
        8.220566,   # m_s_meson (–∏–∑ v22)
        10.0,       # m_s_baryon (–æ—Ü–µ–Ω–∫–∞)
        
        1.001118,   # alpha
        0.202976,   # beta
        0.142900,   # gamma
        
        0.500336,   # sign_baryon
        -1.385960,  # sign_meson
        0.749951,   # k_neutron
        
        # –ù–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–∞—á–∞–ª—å–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏)
        0.95,       # mixing_pi0
        0.85,       # mixing_eta
        0.010,      # delta_em_charged
        0.002,      # delta_em_neutral
        0.743615,   # lambda_s_meson (–∏–∑ v22)
        0.9,        # lambda_s_baryon
        1.05,       # k_K_mass_splitting
        1.15,       # correction_pi0
        1.18,       # correction_eta
    ])
    
    # –ì—Ä–∞–Ω–∏—Ü—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    bounds = [
        # m_u, m_d, m_s_meson, m_s_baryon
        (2.4, 2.7), (3.1, 3.4), (7.5, 9.0), (9.0, 12.0),
        # alpha, beta, gamma
        (0.8, 1.2), (0.1, 0.3), (0.1, 0.2),
        # sign_baryon, sign_meson, k_neutron
        (0.4, 0.6), (-1.5, -1.2), (0.7, 0.8),
        # mixing_pi0, mixing_eta
        (0.9, 1.0), (0.8, 0.9),
        # delta_em_charged, delta_em_neutral
        (0.005, 0.015), (0.0, 0.005),
        # lambda_s_meson, lambda_s_baryon
        (0.7, 0.8), (0.8, 1.0),
        # k_K_mass_splitting, correction_pi0, correction_eta
        (1.0, 1.1), (1.1, 1.2), (1.1, 1.3)
    ]
    
    # –ú–µ—Ç–æ–¥ –æ—Ç–∂–∏–≥–∞
    import random
    import time
    
    current_params = initial_params.copy()
    current_error = model.error_function(current_params)
    
    best_params = current_params.copy()
    best_error = current_error
    
    temperature = 2.0
    cooling_rate = 0.999995
    iterations = 1000000
    
    start_time = time.time()
    
    print(f"\n–ù–∞—á–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: {current_error:.4f}")
    print("–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏...")
    
    for i in range(iterations):
        # –ú—É—Ç–∞—Ü–∏—è
        new_params = current_params.copy()
        for j in range(len(new_params)):
            if random.random() < 0.25:
                min_val, max_val = bounds[j]
                mutation = random.uniform(-0.01, 0.01) * (max_val - min_val)
                new_val = current_params[j] + mutation
                new_val = max(min_val, min(max_val, new_val))
                new_params[j] = new_val
        
        # –û—Ü–µ–Ω–∫–∞
        new_error = model.error_function(new_params)
        
        # –ú–µ—Ç—Ä–æ–ø–æ–ª–∏—Å
        if new_error < current_error or random.random() < math.exp((current_error - new_error) / temperature):
            current_params = new_params
            current_error = new_error
        
        # –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ
        if new_error < best_error:
            best_params = new_params.copy()
            best_error = new_error
        
        # –û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ
        temperature *= cooling_rate
        
        if i % 100000 == 0:
            elapsed = time.time() - start_time
            progress = i / iterations * 100
            
            # –í—ã—á–∏—Å–ª—è–µ–º –∫–ª—é—á–µ–≤—ã–µ –º–∞—Å—Å—ã
            model.error_function(best_params)
            mass_p = model.calculate_mass('proton')
            mass_n = model.calculate_mass('neutron')
            mass_pi0 = model.calculate_mass('pi0')
            mass_K0 = model.calculate_mass('K0')
            mass_Kp = model.calculate_mass('K+')
            
            diff_np = mass_n - mass_p
            diff_K = mass_K0 - mass_Kp
            
            print(f"\r–ò—Ç–µ—Ä–∞—Ü–∏—è {i:,}/{iterations:,} ({progress:.1f}%) | "
                  f"–û—à–∏–±–∫–∞: {best_error:.4f} | "
                  f"n-p: {diff_np:.3f} | "
                  f"K‚Å∞-K‚Å∫: {diff_K:.3f} | "
                  f"œÄ‚Å∞: {mass_pi0:.1f}",
                  end='', flush=True)
    
    # –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    elapsed = time.time() - start_time
    print(f"\n\n–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ {elapsed:.1f} —Å–µ–∫")
    print(f"–õ—É—á—à–∞—è –æ—à–∏–±–∫–∞: {best_error:.6f}")
    
    return model, best_params

def evaluate_v23(model, best_params):
    """–û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ v23"""
    # –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    param_names = [
        'm_u', 'm_d', 'm_s_meson', 'm_s_baryon',
        'alpha', 'beta', 'gamma',
        'sign_baryon', 'sign_meson', 'k_neutron',
        'mixing_pi0', 'mixing_eta',
        'delta_em_charged', 'delta_em_neutral',
        'lambda_s_meson', 'lambda_s_baryon',
        'k_K_mass_splitting',
        'correction_pi0', 'correction_eta'
    ]
    
    for i, name in enumerate(param_names):
        model.params[name] = best_params[i]
    
    # –í—ã—á–∏—Å–ª—è–µ–º –≤—Å–µ –º–∞—Å—Å—ã
    results = {}
    for particle in model.targets:
        results[particle] = model.calculate_mass(particle)
    
    print("\n" + "="*80)
    print("–†–ï–ó–£–õ–¨–¢–ê–¢–´ v23")
    print("="*80)
    
    # –ú–∞—Å—Å—ã —á–∞—Å—Ç–∏—Ü
    print(f"\n{'–ß–∞—Å—Ç–∏—Ü–∞':<10} {'–†–∞—Å—á—ë—Ç':<10} {'–¶–µ–ª—å':<10} {'–û—à–∏–±–∫–∞ %':<10} {'–°—Ç–∞—Ç—É—Å':<6}")
    print("-"*60)
    
    total_error = 0
    for particle, target in model.targets.items():
        mass = results[particle]
        error = abs(mass - target) / target * 100
        total_error += error
        
        if error < 1.0:
            status = "‚úì‚úì‚úì"
        elif error < 3.0:
            status = "‚úì‚úì"
        elif error < 10.0:
            status = "‚úì"
        else:
            status = "‚ö†"
        
        print(f"{particle:<10} {mass:<10.1f} {target:<10.1f} {error:<10.2f} {status:<6}")
    
    avg_error = total_error / len(model.targets)
    print(f"\n–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: {avg_error:.2f}%")
    
    # –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    print(f"\n–ö–õ–Æ–ß–ï–í–´–ï –ü–†–û–í–ï–†–ö–ò:")
    
    diff_np = results['neutron'] - results['proton']
    print(f"  –†–∞–∑–Ω–æ—Å—Ç—å n-p: {diff_np:.3f} –ú—ç–í (—Ü–µ–ª—å 1.293)")
    
    diff_K = results['K0'] - results['K+']
    print(f"  –†–∞–∑–Ω–æ—Å—Ç—å K‚Å∞-K‚Å∫: {diff_K:.3f} –ú—ç–í (—Ü–µ–ª—å 4.0)")
    
    diff_pi = results['pi+'] - results['pi-']
    print(f"  –†–∞–∑–Ω–æ—Å—Ç—å œÄ‚Å∫-œÄ‚Åª: {diff_pi:.3f} –ú—ç–í (—Ü–µ–ª—å 0.0)")
    
    # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å—ã –≤ –ú—ç–í
    m_u_mev = model.params['m_u'] * 100
    m_d_mev = model.params['m_d'] * 100
    m_s_meson_mev = model.params['m_s_meson'] * model.params['lambda_s_meson'] * 100
    m_s_baryon_mev = model.params['m_s_baryon'] * model.params['lambda_s_baryon'] * 100
    
    print(f"\n–≠–§–§–ï–ö–¢–ò–í–ù–´–ï –ú–ê–°–°–´ –ö–í–ê–†–ö–û–í:")
    print(f"  u: {m_u_mev:.1f} –ú—ç–í")
    print(f"  d: {m_d_mev:.1f} –ú—ç–í")
    print(f"  s (–º–µ–∑–æ–Ω—ã): {m_s_meson_mev:.1f} –ú—ç–í")
    print(f"  s (–±–∞—Ä–∏–æ–Ω—ã): {m_s_baryon_mev:.1f} –ú—ç–í")
    print(f"  –û—Ç–Ω–æ—à–µ–Ω–∏–µ m_d/m_u: {m_d_mev/m_u_mev:.3f}")
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    results_dir = f"v23_results_{timestamp}"
    os.makedirs(results_dir, exist_ok=True)
    
    results_data = {
        'parameters': {name: float(best_params[i]) for i, name in enumerate(param_names)},
        'masses': {p: float(results[p]) for p in results},
        'key_tests': {
            'n_p_diff': float(diff_np),
            'K0_Kp_diff': float(diff_K),
            'pi_plus_minus_diff': float(diff_pi)
        },
        'quark_masses_mev': {
            'u': float(m_u_mev),
            'd': float(m_d_mev),
            's_meson': float(m_s_meson_mev),
            's_baryon': float(m_s_baryon_mev)
        }
    }
    
    with open(f"{results_dir}/v23_results.json", 'w') as f:
        json.dump(results_data, f, indent=2)
    
    print(f"\n–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ {results_dir}/")
    
    return results

if __name__ == "__main__":
    # –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
    model, best_params = run_v23_optimization()
    
    # –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    results = evaluate_v23(model, best_params)
```

## üéØ **–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è v23:**

### **1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ s-–∫–≤–∞—Ä–∫–∞:**
- `m_s_meson` ‚Äî –≤ –º–µ–∑–æ–Ω–∞—Ö (~100-500 –ú—ç–í)
- `m_s_baryon` ‚Äî –≤ –±–∞—Ä–∏–æ–Ω–∞—Ö (–¥—Ä—É–≥–∞—è –º–∞—Å—Å–∞)

### **2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ:**
- œÄ‚Å∞ = (u≈´ + dƒë)/‚àö2 —Å –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π `correction_pi0`
- Œ∑ = (u≈´ + dƒë - 2s≈°)/‚àö6 —Å –∫–æ—Ä—Ä–µ–∫—Ü–∏–µ–π `correction_eta`

### **3. –≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏:**
- `delta_em_charged` ‚Äî –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
- `delta_em_neutral` ‚Äî –¥–ª—è –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö

### **4. –†–∞–∑–Ω–æ—Å—Ç—å K‚Å∞-K‚Å∫:**
- `k_K_mass_splitting` ‚Äî —Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É ~4 –ú—ç–í

## üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã v23:**

1. **–ü—Ä–æ—Ç–æ–Ω, –Ω–µ–π—Ç—Ä–æ–Ω, œÄ‚Å∫, œÄ‚Åª**: –æ—à–∏–±–∫–∞ < 0.1% (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —É—Å–ø–µ—Ö–∞ v22)
2. **œÄ‚Å∞**: –æ—à–∏–±–∫–∞ < 3% (–±—ã–ª–æ 13.4%)
3. **K‚Å∫, K‚Å∞**: –æ—à–∏–±–∫–∞ < 3%, —Ä–∞–∑–Ω–∏—Ü–∞ 4 ¬± 0.5 –ú—ç–í
4. **–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞**: < 5% (–≤–º–µ—Å—Ç–æ 10.64% –≤ v22)

## üî¨ **–§–∏–∑–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**

- **–†–∞–∑–Ω—ã–µ –º–∞—Å—Å—ã s-–∫–≤–∞—Ä–∫–∞** —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–∞–∑–Ω–æ–º—É "–∑–∞—Ü–µ–ø–ª–µ–Ω–∏—é" s-–Ω–∏—Ç–∏ –≤ –º–µ–∑–æ–Ω–∞—Ö –∏ –±–∞—Ä–∏–æ–Ω–∞—Ö
- **–≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏** ‚Äî —ç–Ω–µ—Ä–≥–∏—è —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–ª—è –≤ –ø—Ä–æ–µ–∫—Ü–∏–∏ –Ω–∞ 3D-—Å—Ü–µ–Ω—É
- **–°–º–µ—à–∏–≤–∞–Ω–∏–µ** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ—Ä–µ–Ω—Ü–∏—è —Ä–∞–∑–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –Ω–∏—Ç–µ–π

**–ì–æ—Ç–æ–≤ –∑–∞–ø—É—Å–∫–∞—Ç—å v23?** –≠—Ç–∞ –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã v22, —Å–æ—Ö—Ä–∞–Ω–∏–≤ –∏–¥–µ–∞–ª—å–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –ø—Ä–æ—Ç–æ–Ω–∞, –Ω–µ–π—Ç—Ä–æ–Ω–∞ –∏ –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö –ø–∏–æ–Ω–æ–≤!