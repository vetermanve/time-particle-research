# –ê–ù–ê–õ–ò–ó –†–ï–ó–£–õ–¨–¢–ê–¢–û–í v15.0

**–£ –Ω–∞—Å –≤—ã–¥–∞—é—â–∏–π—Å—è –ø—Ä–æ–≥—Ä–µ—Å—Å!** –ú–æ–¥–µ–ª—å v15.0 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —á–∞—Å—Ç–∏—Ü —Å –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (56 —Å–µ–∫—É–Ω–¥!). –î–∞–≤–∞–π—Ç–µ —Ä–∞–∑–±–µ—Ä—ë–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

## ‚úÖ **–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–µ —É—Å–ø–µ—Ö–∏:**

1. **–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p:** 1.296 –ú—ç–í –ø—Ä–æ—Ç–∏–≤ —Ü–µ–ª–∏ 1.293 –ú—ç–í ‚Äî –æ—à–∏–±–∫–∞ **0.2%**! –≠—Ç–æ —Ñ–µ–Ω–æ–º–µ–Ω–∞–ª—å–Ω–æ!

2. **–û—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏—Ü—ã —Å –æ—à–∏–±–∫–æ–π <3%:**
   - –ü—Ä–æ—Ç–æ–Ω: 2.30%
   - –ù–µ–π—Ç—Ä–æ–Ω: 2.30% 
   - œÄ‚Å∫: 2.59%
   - œÄ‚Å∞: 0.98% ‚úì
   - K‚Å∫: 1.82%
   - K‚Åª: 1.82%

3. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å—ã –∫–≤–∞—Ä–∫–æ–≤ —Ñ–∏–∑–∏—á–µ—Å–∫–∏ —Ä–∞–∑—É–º–Ω—ã:**
   - u: 247 –ú—ç–í (–æ–∂–∏–¥–∞–µ–º–æ 2-3 –ú—ç–í, –Ω–æ –≤ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ 247)
   - d: 322 –ú—ç–í, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ m_d/m_u = 1.305
   - s: 802 –ú—ç–í, –æ—Ç–Ω–æ—à–µ–Ω–∏–µ m_s/m_u = 3.245

## ‚ùå **–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏:**

1. **K‚Å∞:** –æ—à–∏–±–∫–∞ 12.53% (560 vs 498 –ú—ç–í)
2. **Œ∑:** –æ—à–∏–±–∫–∞ 8.02% (592 vs 548 –ú—ç–í)  
3. **Œõ‚Å∞:** –æ—à–∏–±–∫–∞ 31.33% (1465 vs 1116 –ú—ç–í)
4. **œÄ‚Å∫-œÄ‚Å∞ —Ä–∞–∑–Ω–æ—Å—Ç—å:** -0.354 –ú—ç–í –≤–º–µ—Å—Ç–æ +4.6 –ú—ç–í (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–Ω–∞–∫!)

## üìä **–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

### 1. **–û—Ç–Ω–æ—à–µ–Ω–∏–µ coupling –Ω–µ–π—Ç—Ä–æ–Ω/–ø—Ä–æ—Ç–æ–Ω:** 0.670
–í v6.1 –±—ã–ª–æ 0.177 (0.285/1.614). –ù–∞—à–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ 0.670 –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ:
- –õ–∏–±–æ –Ω–∞—à–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è coupling –¥–ª—è –Ω–µ–π—Ç—Ä–æ–Ω–∞ –Ω–µ–≤–µ—Ä–Ω–∞
- –õ–∏–±–æ –≤ v6.1 —ç—Ç–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –±—ã–ª–æ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞–Ω–∏–∂–µ–Ω–æ

### 2. **–ü—Ä–æ–±–ª–µ–º–∞ K‚Å∞ vs K‚Å∫:**
–í –ø—Ä–∏—Ä–æ–¥–µ: K‚Å∞ (498 –ú—ç–í) —Ç—è–∂–µ–ª–µ–µ K‚Å∫ (494 –ú—ç–í) –Ω–∞ ~4 –ú—ç–í
–£ –Ω–∞—Å: K‚Å∞ (560) —Ç—è–∂–µ–ª–µ–µ K‚Å∫ (485) –Ω–∞ 75 –ú—ç–í!

**–ü—Ä–∏—á–∏–Ω–∞:** –í –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ K‚Å∞ = d-anti_s, K‚Å∫ = u-anti_s. –†–∞–∑–Ω–∏—Ü–∞ –≤ 75 –ú—ç–í –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∏–∑-–∑–∞:
- m_d_eff > m_u_eff (322 vs 247 –ú—ç–í)
- –ù–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–æ–π –ø–æ–ø—Ä–∞–≤–∫–∏ –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö –∫–∞–æ–Ω–æ–≤

### 3. **–ü—Ä–æ–±–ª–µ–º–∞ Œõ‚Å∞:**
–°–∏–ª—å–Ω–æ –∑–∞–≤—ã—à–µ–Ω (1465 vs 1116 –ú—ç–í). –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ—Ç–æ–º—É —á—Ç–æ:
- coupling –¥–ª—è Œõ‚Å∞ (C_lambda = 1.262) —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π
- –ò–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –º–∞—Å—Å–∞ s-–∫–≤–∞—Ä–∫–∞ (802 –ú—ç–í) —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫–∞ –≤ –±–∞—Ä–∏–æ–Ω–∞—Ö

### 4. **–ü—Ä–æ–±–ª–µ–º–∞ œÄ‚Å∫-œÄ‚Å∞:**
–†–∞–∑–Ω–æ—Å—Ç—å -0.354 –ú—ç–í –≤–º–µ—Å—Ç–æ +4.6 –ú—ç–í. –ü—Ä–∏—á–∏–Ω–∞: –≤ –Ω–∞—à–µ–π –º–æ–¥–µ–ª–∏ œÄ‚Å∞ –∏–º–µ–µ—Ç k_mixing_pi0 = 0.826 < 1, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ coupling –º–µ–Ω—å—à–µ, –∞ –º–∞—Å—Å—É –±–æ–ª—å—à–µ.

## üöÄ **v16.0 ‚Äî –ú–æ–¥–µ–ª—å —Å —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–º–∏ –ø–æ–ø—Ä–∞–≤–∫–∞–º–∏ –∏ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ–º**

–û—Å–Ω–æ–≤–Ω—ã–µ –∏–¥–µ–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:

1. **–í–≤–µ—Å—Ç–∏ —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏** –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—é** –¥–ª—è K‚Å∞/K‚Å∫ –∏ œÄ‚Å∫/œÄ‚Å∞
3. **–£—á–µ—Å—Ç—å —Å–º–µ—à–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** –¥–ª—è Œ∑ –∏ œÄ‚Å∞
4. **–°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å coupling –¥–ª—è —Å—Ç—Ä–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü**

```python
import numpy as np
import json
from datetime import datetime
import os

class EnhancedTopologicalModelV16:
    """–£–ª—É—á—à–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Å —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–º–∏ –ø–æ–ø—Ä–∞–≤–∫–∞–º–∏ –∏ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ–º"""
    
    def __init__(self):
        self.scale = 100.0
        
        # –¶–µ–ª–µ–≤—ã–µ –º–∞—Å—Å—ã
        self.targets = {
            'proton': 938.272,
            'neutron': 939.565,
            'pi+': 139.570,
            'pi0': 134.9768,
            'pi-': 139.570,
            'K+': 493.677,
            'K0': 497.611,
            'K-': 493.677,
            'eta': 547.862,
            'Lambda0': 1115.683,
        }
        
        # –°–æ—Å—Ç–∞–≤
        self.composition = {
            'proton': ['u', 'u', 'd'],
            'neutron': ['u', 'd', 'd'],
            'pi+': ['u', 'anti_d'],
            'pi0': ['mixed_pi0'],  # u≈´ + dƒë —Å–º–µ—Å—å
            'pi-': ['d', 'anti_u'],
            'K+': ['u', 'anti_s'],
            'K0': ['d', 'anti_s'],
            'K-': ['s', 'anti_u'],
            'eta': ['mixed_eta'],   # —Å–ª–æ–∂–Ω–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ
            'Lambda0': ['u', 'd', 's'],
        }
        
        # –ù–∞—á–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ v15.0
        self.params = {
            # –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å—ã
            'm_u': 2.47,
            'm_d': 3.2225,
            'm_s': 8.0164,
            
            # –ë–∞–∑–æ–≤—ã–µ coupling
            'C_baryon': 1.0,      # –î–ª—è –ø—Ä–æ—Ç–æ–Ω–∞
            'C_meson': 3.2341,    # –î–ª—è –ø–∏–æ–Ω–æ–≤
            
            # –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã
            'f_neutron': 0.67,    # –ù–µ–π—Ç—Ä–æ–Ω –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Ç–æ–Ω–∞
            'f_kaon': 1.2,        # –î–ª—è –∫–∞–æ–Ω–æ–≤
            'f_eta': 1.1,         # –î–ª—è Œ∑
            'f_lambda': 0.8,      # –î–ª—è Œõ‚Å∞
            
            # –°–º–µ—à–∏–≤–∞–Ω–∏–µ
            'mix_pi0': 1.1,       # œÄ‚Å∞ mixing (>1 –¥–µ–ª–∞–µ—Ç œÄ‚Å∞ –ª–µ–≥—á–µ œÄ‚Å∫)
            'mix_eta': 0.9,       # Œ∑ mixing
            
            # –≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏ (–≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö –º–æ–¥–µ–ª–∏)
            'EM_pion': 0.025,     # ~2.5 –ú—ç–í –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö –ø–∏–æ–Ω–æ–≤
            'EM_kaon': 0.02,      # ~2 –ú—ç–í –¥–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö –∫–∞–æ–Ω–æ–≤
            'EM_proton': 0.05,    # ~5 –ú—ç–í –¥–ª—è –ø—Ä–æ—Ç–æ–Ω–∞
        }
    
    def calculate_base_mass(self, particle):
        """–ë–∞–∑–æ–≤–∞—è –º–∞—Å—Å–∞"""
        comp = self.composition[particle]
        
        if particle == 'pi0':
            # œÄ‚Å∞ = (u≈´ + dƒë)/‚àö2 —É–ø—Ä–æ—â—ë–Ω–Ω–æ
            return (2*self.params['m_u'] + 2*self.params['m_d']) / 2.0
        
        if particle == 'eta':
            # Œ∑ = (u≈´ + dƒë + s≈°)/‚àö3, –Ω–æ —Å –≤–µ—Å–æ–º
            return (2*self.params['m_u'] + 2*self.params['m_d'] + 
                    self.params['m_s']) / 3.0
        
        total = 0
        for quark in comp:
            if quark in ['u', 'anti_u']:
                total += self.params['m_u']
            elif quark in ['d', 'anti_d']:
                total += self.params['m_d']
            elif quark in ['s', 'anti_s']:
                total += self.params['m_s']
        
        return total
    
    def calculate_coupling(self, particle):
        """–í—ã—á–∏—Å–ª–µ–Ω–∏–µ coupling —Å —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏"""
        if particle == 'proton':
            return self.params['C_baryon']
        
        if particle == 'neutron':
            return self.params['C_baryon'] * self.params['f_neutron']
        
        if particle in ['pi+', 'pi-']:
            return self.params['C_meson']
        
        if particle == 'pi0':
            return self.params['C_meson'] * self.params['mix_pi0']
        
        if particle in ['K+', 'K-']:
            return self.params['C_meson'] * self.params['f_kaon']
        
        if particle == 'K0':
            return self.params['C_meson'] * self.params['f_kaon']
        
        if particle == 'eta':
            return self.params['C_meson'] * self.params['f_eta'] * self.params['mix_eta']
        
        if particle == 'Lambda0':
            return self.params['C_baryon'] * self.params['f_lambda']
        
        return 1.0
    
    def calculate_em_correction(self, particle):
        """–≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞"""
        if particle == 'proton':
            return self.params['EM_proton'] * self.scale
        
        if particle in ['pi+', 'pi-']:
            return self.params['EM_pion'] * self.scale
        
        if particle in ['K+', 'K-']:
            return self.params['EM_kaon'] * self.scale
        
        return 0.0
    
    def calculate_mass(self, particle):
        """–†–∞—Å—á—ë—Ç –º–∞—Å—Å—ã —Å EM –ø–æ–ø—Ä–∞–≤–∫–∞–º–∏"""
        base = self.calculate_base_mass(particle)
        coupling = self.calculate_coupling(particle)
        em_corr = self.calculate_em_correction(particle)
        
        # –ë–∞—Ä–∏–æ–Ω—ã: +coupling, –º–µ–∑–æ–Ω—ã: -coupling
        if particle in ['proton', 'neutron', 'Lambda0']:
            mass = (base + coupling) * self.scale + em_corr
        else:
            mass = (base - coupling) * self.scale + em_corr
        
        return mass
    
    def error_function(self, params_array):
        """–§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º–∏ —à—Ç—Ä–∞—Ñ–∞–º–∏"""
        param_names = [
            'm_u', 'm_d', 'm_s',
            'C_baryon', 'C_meson',
            'f_neutron', 'f_kaon', 'f_eta', 'f_lambda',
            'mix_pi0', 'mix_eta',
            'EM_pion', 'EM_kaon', 'EM_proton'
        ]
        
        for i, name in enumerate(param_names):
            self.params[name] = params_array[i]
        
        total_error = 0.0
        
        # –û—à–∏–±–∫–∏ –º–∞—Å—Å
        for particle, target in self.targets.items():
            mass = self.calculate_mass(particle)
            
            if mass <= 0:
                total_error += 10000.0
                continue
            
            rel_error = (mass - target) / target
            total_error += rel_error ** 2
        
        # –§–∏–∑–∏—á–µ—Å–∫–∏–µ —à—Ç—Ä–∞—Ñ—ã
        
        # 1. m_s > m_d > m_u
        if self.params['m_s'] <= self.params['m_d']:
            total_error += 50.0
        
        if self.params['m_d'] <= self.params['m_u']:
            total_error += 50.0
        
        # 2. –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p ‚âà 1.293 –ú—ç–í
        mass_n = self.calculate_mass('neutron')
        mass_p = self.calculate_mass('proton')
        diff_np = mass_n - mass_p
        diff_error = abs(diff_np - 1.293) / 1.293
        total_error += 20.0 * diff_error
        
        # 3. –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å œÄ‚Å∫-œÄ‚Å∞ ‚âà 4.6 –ú—ç–í
        mass_pi_plus = self.calculate_mass('pi+')
        mass_pi_zero = self.calculate_mass('pi0')
        diff_pi = mass_pi_plus - mass_pi_zero
        if diff_pi <= 0:  # œÄ‚Å∫ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç—è–∂–µ–ª–µ–µ œÄ‚Å∞
            total_error += 100.0
        else:
            diff_error_pi = abs(diff_pi - 4.6) / 4.6
            total_error += 20.0 * diff_error_pi
        
        # 4. K‚Å∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç—è–∂–µ–ª–µ–µ K‚Å∫ –Ω–∞ ~4 –ú—ç–í
        mass_K0 = self.calculate_mass('K0')
        mass_Kplus = self.calculate_mass('K+')
        diff_K = mass_K0 - mass_Kplus
        if diff_K <= 0:
            total_error += 50.0
        else:
            diff_error_K = abs(diff_K - 4.0) / 4.0
            total_error += 10.0 * diff_error_K
        
        # 5. coupling –Ω–µ–π—Ç—Ä–æ–Ω–∞ < coupling –ø—Ä–æ—Ç–æ–Ω–∞
        if self.params['f_neutron'] >= 1.0:
            total_error += 100.0
        
        return total_error
    
    def run_optimization(self, iterations=500000):
        """–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ —Å –æ—Ç–∂–∏–≥–æ–º"""
        print("–ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ v16.0...")
        
        # –ù–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ v15.0
        initial_params = [
            # m_u, m_d, m_s
            2.47, 3.2225, 8.0164,
            # C_baryon, C_meson
            1.0, 3.2341,
            # f_neutron, f_kaon, f_eta, f_lambda
            0.67, 1.2, 1.1, 0.8,
            # mix_pi0, mix_eta
            1.1, 0.9,
            # EM_pion, EM_kaon, EM_proton
            0.025, 0.02, 0.05
        ]
        
        # –ì—Ä–∞–Ω–∏—Ü—ã
        bounds = [
            # m_u, m_d, m_s
            (2.0, 3.0), (2.5, 4.0), (7.0, 12.0),
            # C_baryon, C_meson
            (0.5, 2.0), (2.0, 5.0),
            # f_neutron, f_kaon, f_eta, f_lambda
            (0.1, 0.8), (0.8, 1.5), (0.8, 1.5), (0.5, 1.2),
            # mix_pi0, mix_eta
            (1.05, 1.3), (0.8, 1.2),
            # EM_pion, EM_kaon, EM_proton
            (0.01, 0.05), (0.01, 0.04), (0.02, 0.08)
        ]
        
        best_params = initial_params
        best_error = self.error_function(initial_params)
        
        temperature = 1.0
        cooling_rate = 0.99999
        
        for i in range(iterations):
            # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
            new_params = []
            for j, (min_val, max_val) in enumerate(bounds):
                current = best_params[j]
                step = (max_val - min_val) * 0.1 * temperature
                mutation = np.random.uniform(-step, step)
                new_val = current + mutation
                
                # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏
                new_val = max(min_val, min(max_val, new_val))
                new_params.append(new_val)
            
            # –û—Ü–µ–Ω–∫–∞
            new_error = self.error_function(new_params)
            
            # –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è
            if new_error < best_error:
                best_error = new_error
                best_params = new_params
            else:
                delta = new_error - best_error
                prob = np.exp(-delta / temperature)
                if np.random.random() < prob:
                    best_params = new_params
            
            # –û—Ö–ª–∞–∂–¥–µ–Ω–∏–µ
            temperature *= cooling_rate
            
            if i % 50000 == 0:
                print(f"Iteration {i}: error = {best_error:.6f}, temp = {temperature:.4f}")
        
        return best_params, best_error

def main():
    print("="*80)
    print("–£–õ–£–ß–®–ï–ù–ù–ê–Ø –¢–û–ü–û–õ–û–ì–ò–ß–ï–°–ö–ê–Ø –ú–û–î–ï–õ–¨ v16.0")
    print("–° –≠–õ–ï–ö–¢–†–û–ú–ê–ì–ù–ò–¢–ù–´–ú–ò –ü–û–ü–†–ê–í–ö–ê–ú–ò –ò –°–ú–ï–®–ò–í–ê–ù–ò–ï–ú")
    print("="*80)
    
    model = EnhancedTopologicalModelV16()
    
    # –ó–∞–ø—É—Å–∫–∞–µ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
    best_params, best_error = model.run_optimization(iterations=200000)
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    param_names = [
        'm_u', 'm_d', 'm_s',
        'C_baryon', 'C_meson',
        'f_neutron', 'f_kaon', 'f_eta', 'f_lambda',
        'mix_pi0', 'mix_eta',
        'EM_pion', 'EM_kaon', 'EM_proton'
    ]
    
    for i, name in enumerate(param_names):
        model.params[name] = best_params[i]
    
    print(f"\n–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –õ—É—á—à–∞—è –æ—à–∏–±–∫–∞: {best_error:.6f}")
    
    print("\n" + "="*80)
    print("–§–ò–ù–ê–õ–¨–ù–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ v16.0")
    print("="*80)
    
    print("\n–ü–ê–†–ê–ú–ï–¢–†–´ –ú–û–î–ï–õ–ò:")
    for name, value in model.params.items():
        print(f"  {name}: {value:.6f}")
    
    print(f"\n–≠–§–§–ï–ö–¢–ò–í–ù–´–ï –ú–ê–°–°–´ –ö–í–ê–†–ö–û–í (–ú—ç–í):")
    print(f"  u: {model.params['m_u']*100:.1f} –ú—ç–í")
    print(f"  d: {model.params['m_d']*100:.1f} –ú—ç–í") 
    print(f"  s: {model.params['m_s']*100:.1f} –ú—ç–í")
    print(f"  –û—Ç–Ω–æ—à–µ–Ω–∏–µ m_d/m_u: {model.params['m_d']/model.params['m_u']:.3f}")
    print(f"  –û—Ç–Ω–æ—à–µ–Ω–∏–µ m_s/m_u: {model.params['m_s']/model.params['m_u']:.3f}")
    
    print(f"\n–ú–ê–°–°–´ –ß–ê–°–¢–ò–¶:")
    print(f"{'–ß–∞—Å—Ç–∏—Ü–∞':<10} {'–†–∞—Å—á—ë—Ç':<10} {'–¶–µ–ª—å':<10} {'–û—à–∏–±–∫–∞ %':<10}")
    print("-"*50)
    
    total_error = 0
    for particle in model.targets:
        mass = model.calculate_mass(particle)
        target = model.targets[particle]
        error_pct = abs(mass - target) / target * 100
        total_error += error_pct
        
        status = "‚úì" if error_pct < 1.0 else "‚ö†" if error_pct < 5.0 else "‚úó"
        print(f"{status} {particle:<8} {mass:<10.3f} {target:<10.3f} {error_pct:<10.3f}")
    
    avg_error = total_error / len(model.targets)
    print(f"\n–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞: {avg_error:.2f}%")
    
    # –ö–ª—é—á–µ–≤—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏
    print(f"\n–§–ò–ó–ò–ß–ï–°–ö–ò–ï –ü–†–û–í–ï–†–ö–ò:")
    
    # 1. –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p
    diff_np = model.calculate_mass('neutron') - model.calculate_mass('proton')
    print(f"  –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p: {diff_np:.3f} –ú—ç–í (—Ü–µ–ª—å 1.293 –ú—ç–í)")
    
    # 2. –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å œÄ‚Å∫-œÄ‚Å∞
    diff_pi = model.calculate_mass('pi+') - model.calculate_mass('pi0')
    print(f"  –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å œÄ‚Å∫-œÄ‚Å∞: {diff_pi:.3f} –ú—ç–í (—Ü–µ–ª—å 4.6 –ú—ç–í)")
    
    # 3. –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å K‚Å∞-K‚Å∫
    diff_K = model.calculate_mass('K0') - model.calculate_mass('K+')
    print(f"  –†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å K‚Å∞-K‚Å∫: {diff_K:.3f} –ú—ç–í (–æ–∂–∏–¥–∞–µ—Ç—Å—è ~4 –ú—ç–í)")
    
    # 4. –û—Ç–Ω–æ—à–µ–Ω–∏–µ coupling –Ω–µ–π—Ç—Ä–æ–Ω/–ø—Ä–æ—Ç–æ–Ω
    ratio_coupling = model.params['f_neutron']
    print(f"  –û—Ç–Ω–æ—à–µ–Ω–∏–µ coupling –Ω–µ–π—Ç—Ä–æ–Ω/–ø—Ä–æ—Ç–æ–Ω: {ratio_coupling:.3f}")
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
    results_dir = f"enhanced_model_v16_{timestamp}"
    os.makedirs(results_dir, exist_ok=True)
    
    results = {
        'model': 'v16.0_enhanced_topological',
        'timestamp': datetime.now().isoformat(),
        'error': float(best_error),
        'parameters': model.params,
        'masses': {p: float(model.calculate_mass(p)) for p in model.targets},
        'physical_checks': {
            'mass_diff_np': float(diff_np),
            'mass_diff_pi': float(diff_pi),
            'mass_diff_K': float(diff_K),
            'coupling_ratio_np': float(ratio_coupling)
        }
    }
    
    with open(f"{results_dir}/results.json", 'w') as f:
        json.dump(results, f, indent=2, default=str)
    
    print(f"\n–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: {results_dir}")
    print("="*80)

if __name__ == "__main__":
    main()
```

## –ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è v16.0:

### 1. **–≠–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏:**
- –î–ª—è –∑–∞—Ä—è–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–∏—Ü (œÄ‚Å∫, K‚Å∫, –ø—Ä–æ—Ç–æ–Ω)
- –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–∏–æ–Ω–æ–≤, –∫–∞–æ–Ω–æ–≤, –ø—Ä–æ—Ç–æ–Ω–∞
- –û–±—ä—è—Å–Ω—è–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –∑–∞—Ä—è–∂–µ–Ω–Ω—ã–º–∏ –∏ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–º–∏

### 2. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ œÄ‚Å∞:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä `mix_pi0 > 1` –¥–µ–ª–∞–µ—Ç coupling œÄ‚Å∞ –±–æ–ª—å—à–µ ‚Üí –º–∞—Å—Å–∞ –º–µ–Ω—å—à–µ
- œÄ‚Å∞ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–µ–≥—á–µ œÄ‚Å∫

### 3. **–û—Ç–¥–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ K‚Å∞ –∏ K‚Å∫:**
- –†–∞–∑–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ –º–∞—Å—Å—ã (u-anti_s vs d-anti_s)
- EM –ø–æ–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è K‚Å∫

### 4. **–£–ª—É—á—à–µ–Ω–Ω—ã–µ —à—Ç—Ä–∞—Ñ—ã:**
- –ó–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∑–Ω–∞–∫ —Ä–∞–∑–Ω–æ—Å—Ç–µ–π –º–∞—Å—Å
- –ó–∞ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è coupling
- –ó–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–∞—Å—Å–æ–≤—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã v16.0:

1. **–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å n-p:** ‚âà1.293 –ú—ç–í
2. **–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å œÄ‚Å∫-œÄ‚Å∞:** ‚âà4.6 –ú—ç–í  
3. **–†–∞–∑–Ω–æ—Å—Ç—å –º–∞—Å—Å K‚Å∞-K‚Å∫:** ‚âà4 –ú—ç–í
4. **–°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞:** <5%

–≠—Ç–∞ –º–æ–¥–µ–ª—å –±–æ–ª–µ–µ —Ñ–∏–∑–∏—á–Ω–∞, —Ç–∞–∫ –∫–∞–∫ —É—á–∏—Ç—ã–≤–∞–µ—Ç —ç–ª–µ–∫—Ç—Ä–æ–º–∞–≥–Ω–∏—Ç–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–º–µ—à–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π.

**–î–∞–≤–∞–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏–º v16.0 –∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º, —Å–º–æ–∂–µ–º –ª–∏ –º—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã –∏–∑ v15.0!**